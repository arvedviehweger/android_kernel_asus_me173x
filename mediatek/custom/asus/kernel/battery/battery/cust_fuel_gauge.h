#include <mach/mt_typedefs.h>
#define CHANGE_TRACKING_POINT
#define CUST_TRACKING_POINT 0

#define TEMPERATURE_T0                  110
#define TEMPERATURE_T1                  0
#define TEMPERATURE_T2                  25
#define TEMPERATURE_T3                  50
#define TEMPERATURE_T                   255 // This should be fixed, never change the value

#define FG_METER_RESISTANCE 	0

#define MAX_BOOTING_TIME_FGCURRENT	1*10 // 10s

#if defined(CONFIG_POWER_EXT)
#define OCV_BOARD_COMPESATE	72 //mV 
#define R_FG_BOARD_BASE		1000
#define R_FG_BOARD_SLOPE	1000 //slope
#else
#define OCV_BOARD_COMPESATE	0 //mV 
#define R_FG_BOARD_BASE		1000
#define R_FG_BOARD_SLOPE	1000 //slope
#endif

#define Q_MAX_POS_50	7117
#define Q_MAX_POS_25	7211
#define Q_MAX_POS_0		7006
#define Q_MAX_NEG_10	6371

#define Q_MAX_POS_50_H_CURRENT	7128
#define Q_MAX_POS_25_H_CURRENT	7140
#define Q_MAX_POS_0_H_CURRENT	6599
#define Q_MAX_NEG_10_H_CURRENT	4515

#define R_FG_VALUE 				20 // mOhm, base is 20
#define CURRENT_DETECT_R_FG	100  //10mA

#define OSR_SELECT_7			0

#define CAR_TUNE_VALUE			102 //0.98

/////////////////////////////////////////////////////////////////////
// <DOD, Battery_Voltage> Table
/////////////////////////////////////////////////////////////////////
typedef struct _BATTERY_PROFILE_STRUC
{
    kal_int32 percentage;
    kal_int32 voltage;
} BATTERY_PROFILE_STRUC, *BATTERY_PROFILE_STRUC_P;

typedef enum
{
    T1_0C,
    T2_25C,
    T3_50C
} PROFILE_TEMPERATURE;

// T0 -10C
BATTERY_PROFILE_STRUC battery_profile_t0[] =
{
{0,4117},
{1,4103},
{3,4092},
{4,4082},
{5,4071},
{6,4058},
{8,4045},
{9,4033},
{10,4020},
{11,4010},
{13,4000},
{14,3992},
{15,3985},
{16,3977},
{18,3970},
{19,3963},
{20,3957},
{21,3952},
{23,3947},
{24,3940},
{25,3935},
{28,3922},
{29,3914},
{30,3907},
{31,3899},
{33,3891},
{34,3882},
{35,3872},
{36,3865},
{38,3855},
{39,3848},
{40,3840},
{41,3834},
{43,3829},
{45,3820},
{46,3816},
{48,3813},
{49,3810},
{50,3807},
{51,3805},
{53,3802},
{54,3800},
{55,3798},
{56,3795},
{58,3794},
{59,3793},
{60,3791},
{61,3790},
{63,3790},
{64,3788},
{66,3786},
{68,3785},
{69,3783},
{70,3780},
{71,3778},
{73,3778},
{74,3775},
{75,3771},
{77,3769},
{78,3764},
{79,3760},
{80,3755},
{82,3749},
{83,3742},
{84,3736},
{85,3729},
{87,3720},
{88,3715},
{89,3708},
{90,3705},
{92,3702},
{93,3699},
{94,3696},
{95,3694},
{96,3691},
{97,3688},
{98,3687},
{99,3681},
{100,3673}
};   
     
// T1 0C
BATTERY_PROFILE_STRUC battery_profile_t1[] =
{
 {0,4149}, 
 {1,4136}, 
 {2,4125}, 
 {3,4115}, 
 {5,4104}, 
 {6,4096}, 
 {8,4080}, 
 {9,4070}, 
 {10,4058},
 {11,4048},
 {13,4037},
 {14,4026},
 {15,4015},
 {16,4007},
 {18,3990},
 {19,3983},
 {21,3976},
 {22,3970},
 {23,3962},
 {25,3951},
 {26,3946},
 {27,3939},
 {29,3934},
 {31,3921},
 {32,3915},
 {33,3908},
 {34,3901},
 {36,3884},
 {38,3875},
 {39,3865},
 {40,3855},
 {41,3848},
 {42,3839},
 {44,3829},
 {46,3824},
 {47,3820},
 {48,3815},
 {49,3813},
 {51,3806},
 {52,3803},
 {54,3800},
 {55,3797},
 {56,3795},
 {57,3793},
 {59,3790},
 {60,3789},
 {62,3787},
 {63,3785},
 {64,3784},
 {65,3783},
 {67,3781},
 {68,3780},
 {70,3778},
 {71,3778},
 {72,3777},
 {73,3775},
 {75,3769},
 {76,3766},
 {78,3762},
 {79,3756},
 {80,3751},
 {81,3744},
 {82,3734},
 {83,3726},
 {84,3717},
 {86,3708},
 {87,3701},
 {88,3697},
 {89,3694},
 {90,3693},
 {91,3690},
 {92,3688},
 {93,3684},
 {95,3677},
 {96,3660},
 {97,3622},
 {98,3569},
 {99,3529},
 {100,3482}
};

// T2 25C
BATTERY_PROFILE_STRUC battery_profile_t2[] =
{
{0,4169},   
{1,4158},  	
{2,4147},  	
{3,4138},  	
{4,4128},  	
{6,4117},  	
{7,4107},  	
{8,4097},  	
{9,4089},  	
{10,4082}, 	
{11,4072}, 	
{12,4062}, 	
{13,4053}, 	
{14,4043}, 	
{16,4032}, 	
{18,4014}, 	
{19,4006}, 	
{20,3996}, 	
{21,3990}, 	
{22,3982}, 	
{23,3975}, 	
{24,3970}, 	
{25,3964}, 	
{27,3956}, 	
{29,3945}, 	
{30,3939}, 	
{31,3932}, 	
{32,3926}, 	
{33,3919}, 	
{34,3913}, 	
{35,3909}, 	
{38,3895}, 	
{39,3890}, 	
{40,3880}, 	
{41,3868}, 	
{42,3857}, 	
{43,3847}, 	
{44,3839}, 	
{45,3832}, 	
{48,3824}, 	
{49,3820}, 	
{50,3816}, 	
{51,3812}, 	
{52,3810}, 	
{53,3807}, 	
{55,3801}, 	
{56,3797}, 	
{58,3795}, 	
{59,3793}, 	
{61,3788}, 	
{62,3786}, 	
{63,3784}, 	
{64,3782}, 	
{65,3780}, 	
{68,3778}, 	
{69,3777}, 	
{70,3774}, 	
{71,3773}, 	
{72,3770}, 	
{74,3763}, 	
{75,3760}, 	
{76,3756}, 	
{78,3751}, 	
{80,3743}, 	
{81,3738}, 	
{82,3731}, 	
{83,3721}, 	
{85,3702}, 	
{86,3693}, 	
{88,3689}, 	
{90,3688}, 	
{91,3686}, 	
{92,3684}, 	
{93,3681}, 	
{94,3677}, 	
{96,3632}, 	
{97,3583}, 	
{99,3520}, 	
{100,3434} 	
};

// T3 50C
BATTERY_PROFILE_STRUC battery_profile_t3[] =
{
{0,4173},
{1,4162},
{2,4150},
{3,4139},
{4,4130},
{6,4120},
{7,4109},
{8,4099},
{9,4090},
{10,4080}, 	
{12,4063}, 	
{13,4054}, 	
{15,4045}, 	
{16,4035}, 	
{17,4025}, 	
{18,4017}, 	
{19,4009}, 	
{20,4003}, 	
{22,3986}, 	
{24,3979}, 	
{25,3971}, 	
{26,3965}, 	
{27,3956}, 	
{28,3951}, 	
{29,3945}, 	
{31,3931}, 	
{33,3926}, 	
{34,3918}, 	
{35,3913}, 	
{37,3901}, 	
{38,3894}, 	
{39,3890}, 	
{40,3879}, 	
{42,3870}, 	
{43,3856}, 	
{44,3847}, 	
{46,3832}, 	
{47,3829}, 	
{48,3824}, 	
{49,3820}, 	
{51,3816}, 	
{53,3810}, 	
{54,3806}, 	
{55,3802}, 	
{56,3799}, 	
{57,3796}, 	
{58,3793}, 	
{60,3792}, 	
{62,3786}, 	
{63,3784}, 	
{64,3782}, 	
{65,3779}, 	
{66,3777}, 	
{67,3774}, 	
{68,3773}, 	
{70,3770}, 	
{72,3755}, 	
{73,3753}, 	
{74,3749}, 	
{75,3746}, 	
{76,3742}, 	
{77,3737}, 	
{79,3733}, 	
{80,3728}, 	
{82,3719}, 	
{83,3713}, 	
{84,3703}, 	
{85,3694}, 	
{86,3684}, 	
{88,3675}, 	
{89,3674}, 	
{91,3672}, 	
{92,3670}, 	
{93,3669}, 	
{94,3666}, 	
{95,3660}, 	
{97,3636}, 	
{99,3548}, 	
{100,3478} 	
};

// battery profile for actual temperature. The size should be the same as T1, T2 and T3
BATTERY_PROFILE_STRUC battery_profile_temperature[] =
{
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0}    
};

/////////////////////////////////////////////////////////////////////
// <Rbat, Battery_Voltage> Table
/////////////////////////////////////////////////////////////////////
typedef struct _R_PROFILE_STRUC
{
    kal_int32 resistance; // Ohm
    kal_int32 voltage;
} R_PROFILE_STRUC, *R_PROFILE_STRUC_P;

// T0 -10C
R_PROFILE_STRUC r_profile_t0[] =
{
{474,4117}, 	    
{474,4103}, 	    
{491,4092}, 	    
{505,4082}, 	    
{515,4071}, 	    
{524,4058}, 	    
{534,4045}, 	    
{541,4033}, 	    
{543,4020}, 	    
{553,4010}, 	    
{560,4000}, 	    
{565,3992}, 	    
{574,3985}, 	    
{581,3977}, 		
{589,3970}, 		
{596,3963}, 		
{603,3957}, 		
{615,3952}, 		
{627,3947}, 		
{634,3940}, 		
{646,3935}, 		
{662,3922}, 		
{667,3914}, 		
{672,3907}, 		
{679,3899}, 		
{682,3891}, 		
{684,3882}, 		
{689,3872}, 		
{689,3865}, 		
{689,3855}, 		
{691,3848}, 		
{691,3840}, 		
{698,3834}, 		
{701,3829}, 		
{713,3820}, 		
{720,3816}, 		
{729,3813}, 		
{736,3810}, 		
{743,3807}, 		
{751,3805}, 		
{758,3802}, 		
{767,3800}, 		
{774,3798}, 		
{786,3795}, 		
{798,3794}, 		
{810,3793}, 		
{822,3791}, 		
{839,3790}, 		
{853,3790}, 		
{865,3788}, 		
{898,3786}, 		
{915,3785}, 		
{927,3783}, 		
{941,3780}, 		
{953,3778}, 		
{972,3778}, 		
{1006,3775},		
{1020,3771},		
{1037,3769},		
{1051,3764},		
{1063,3760},		
{1082,3755},		
{1101,3749},		
{1118,3742},		
{1137,3736},		
{1156,3729},		
{1172,3720},		
{1196,3715},		
{1208,3708},		
{1239,3705},		
{1256,3702},		
{1249,3699},		
{1242,3696},		
{1237,3694},		
{1230,3691},		
{1222,3688},		
{1218,3687},		
{1203,3681},		
{1184,3673} 		
};

// T1 0C
R_PROFILE_STRUC r_profile_t1[] =
{
{250,4149},
{250,4136},
{257,4125},
{260,4115},
{262,4104},
{262,4096},
{269,4080},
{272,4070},
{272,4058},
{279,4048},
{279,4037},
{286,4026},
{286,4015},
{291,4007},
{300,3990},
{305,3983},
{303,3976},
{310,3970},
{310,3962},
{317,3951},
{326,3946},
{326,3939},
{334,3934},
{338,3921},
{345,3915},
{348,3908},
{353,3901},
{348,3884},
{343,3875},
{338,3865},
{334,3855},
{331,3848},
{326,3839},
{331,3829},
{331,3824},
{336,3820},
{334,3815},
{343,3813},
{345,3806},
{350,3803},
{357,3800},
{360,3797},
{362,3795},
{367,3793},
{376,3790},
{381,3789},
{388,3787},
{396,3785},
{403,3784},
{415,3783},
{431,3781},
{438,3780},
{448,3778},
{457,3778},
{465,3777},
{472,3775},
{479,3769},
{486,3766},
{493,3762},
{498,3756},
{503,3751},
{510,3744},
{515,3734},
{524,3726},
{534,3717},
{546,3708},
{555,3701},
{560,3697},
{574,3694},
{596,3693},
{617,3690},
{646,3688},
{677,3684},
{712,3677},
{743,3660},
{767,3622},
{812,3569},
{822,3529},
{705,3482}
};


// T2 25C
R_PROFILE_STRUC r_profile_t2[] =
{
{145,4169},  
{145,4158},  
{145,4147},  
{150,4138},  
{150,4128},  
{148,4117},  
{145,4107},  
{148,4097},  
{150,4089},  
{155,4082},  
{152,4072},  
{150,4062},  
{152,4053},  
{152,4043},  
{152,4032},  
{157,4014},  
{157,4006},  
{155,3996},  
{157,3990},  
{159,3982},  
{159,3975},  
{159,3970},  
{167,3964},  
{162,3956},  
{167,3945},  
{171,3939},  
{171,3932},  
{171,3926},  
{171,3919},  
{174,3913},  
{181,3909},  
{183,3895},  
{188,3890},  
{183,3880},  
{174,3868},  
{167,3857},  
{159,3847},  
{159,3839},  
{155,3832},  
{155,3824},  
{157,3820},  
{157,3816},  
{157,3812},  
{157,3810},  
{157,3807},  
{159,3801},  
{159,3797},  
{159,3795},  
{159,3793},  
{162,3788},  
{162,3786},  
{164,3784},  
{164,3782},  
{164,3780},  
{169,3778},  
{169,3777},  
{167,3774},  
{167,3773},  
{164,3770},  
{164,3763},  
{169,3760},  
{169,3756},  
{167,3751},  
{169,3743},  
{169,3738},  
{171,3731},  
{171,3721},  
{178,3702},  
{181,3693},  
{176,3689},  
{186,3688},  
{186,3686},  
{188,3684},  
{190,3681},  
{195,3677},  
{198,3632},  
{207,3583},  
{217,3520},  
{226,3434}   
};

// T3 50C
R_PROFILE_STRUC r_profile_t3[] =
{
{126,4173},   	
{126,4162},   	
{126,4150},  	
{124,4139},  	
{131,4130},  	
{128,4120},  	
{128,4109},  	
{126,4099},  	
{131,4090},  	
{128,4080},		
{133,4063},		
{128,4054},		
{128,4045},		
{128,4035},		
{126,4025},		
{131,4017},		
{133,4009},		
{136,4003},		
{131,3986},		
{136,3979},		
{133,3971},		
{136,3965},		
{133,3956},		
{138,3951},		
{138,3945},		
{143,3931},		
{145,3926},		
{140,3918},		
{143,3913},		
{148,3901},		
{148,3894},		
{152,3890},		
{150,3879},		
{150,3870},		
{138,3856},		
{136,3847},		
{131,3832},		
{133,3829},		
{131,3824},		
{133,3820},		
{131,3816},		
{136,3810},		
{136,3806},		
{131,3802},		
{133,3799},		
{136,3796},		
{133,3793},		
{138,3792},		
{138,3786},		
{138,3784},		
{140,3782},		
{138,3779},		
{138,3777},		
{138,3774},		
{140,3773},		
{143,3770},		
{133,3755},		
{138,3753},		
{133,3749},		
{133,3746},		
{136,3742},		
{133,3737},		
{131,3733},		
{131,3728},		
{136,3719},		
{136,3713},		
{133,3703},		
{133,3694},		
{136,3684},		
{133,3675},		
{136,3674},		
{136,3672},		
{138,3670},		
{140,3669},		
{140,3666},		
{143,3660},		
{138,3636},		
{152,3548},		
{148,3478}		
};

// r-table profile for actual temperature. The size should be the same as T1, T2 and T3
R_PROFILE_STRUC r_profile_temperature[] =
{
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0}    
};


int fgauge_get_saddles(void);
BATTERY_PROFILE_STRUC_P fgauge_get_profile(kal_uint32 temperature);

int fgauge_get_saddles_r_table(void);
R_PROFILE_STRUC_P fgauge_get_profile_r_table(kal_uint32 temperature);

//#define CONFIG_POWER_VERIFY
