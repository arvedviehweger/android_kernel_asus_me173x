#include <mach/mt_typedefs.h>

#define TEMPERATURE_T0                  110
#define TEMPERATURE_T1                  0
#define TEMPERATURE_T2                  25
#define TEMPERATURE_T3                  50
#define TEMPERATURE_T                   255 // This should be fixed, never change the value

#define FG_METER_RESISTANCE 	0

#define MAX_BOOTING_TIME_FGCURRENT	1*10 // 10s

#if defined(CONFIG_POWER_EXT)
#define OCV_BOARD_COMPESATE	72 //mV 
#define R_FG_BOARD_BASE		1000
#define R_FG_BOARD_SLOPE	1000 //slope
#else
#define OCV_BOARD_COMPESATE	0 //mV 
#define R_FG_BOARD_BASE		1000
#define R_FG_BOARD_SLOPE	1000 //slope
#endif

#define Q_MAX_POS_50	4079
#define Q_MAX_POS_25	4061
#define Q_MAX_POS_0	4123
#define Q_MAX_NEG_10	3763

#define Q_MAX_POS_50_H_CURRENT	3987
#define Q_MAX_POS_25_H_CURRENT	3923
#define Q_MAX_POS_0_H_CURRENT	3271
#define Q_MAX_NEG_10_H_CURRENT	2623

#define R_FG_VALUE 				20 // mOhm, base is 20
#define CURRENT_DETECT_R_FG	100  //10mA

#define OSR_SELECT_7			0

// Modify the CAR_TUNE_VALUE from 98(default) to 103(measurement)
#define CAR_TUNE_VALUE			103 //1.03

/////////////////////////////////////////////////////////////////////
// <DOD, Battery_Voltage> Table
/////////////////////////////////////////////////////////////////////
typedef struct _BATTERY_PROFILE_STRUC
{
    kal_int32 percentage;
    kal_int32 voltage;
} BATTERY_PROFILE_STRUC, *BATTERY_PROFILE_STRUC_P;

typedef enum
{
    T1_0C,
    T2_25C,
    T3_50C
} PROFILE_TEMPERATURE;

// T0 -10C
BATTERY_PROFILE_STRUC battery_profile_t0[] =
{
    {0  ,4158},
    {2  ,4128},
    {4  ,4102},
    {6  ,4078},
    {7  ,4057},
    {9  ,4037},
    {11 ,4020},
    {13 ,4006},
    {15 ,3992},
    {17 ,3980},
    {18 ,3968},
    {20 ,3957},
    {22 ,3945},
    {24 ,3934},
    {26 ,3923},
    {28 ,3912},
    {29 ,3901},
    {31 ,3890},
    {33 ,3878},
    {35 ,3867},
    {37 ,3856},
    {39 ,3844},
    {40 ,3834},
    {42 ,3824},
    {44 ,3816},
    {46 ,3808},
    {48 ,3803},
    {50 ,3798},
    {52 ,3793},
    {53 ,3790},
    {55 ,3788},
    {57 ,3786},
    {59 ,3784},
    {61 ,3783},
    {63 ,3781},
    {64 ,3779},
    {66 ,3776},
    {68 ,3774},
    {70 ,3770},
    {72 ,3766},
    {74 ,3761},
    {75 ,3755},
    {77 ,3748},
    {79 ,3738},
    {81 ,3727},
    {83 ,3713},
    {85 ,3698},
    {87 ,3681},
    {88 ,3663},
    {90 ,3645},
    {92 ,3627},
    {94 ,3612},
    {95 ,3602},
    {96 ,3597},
    {96 ,3594},
    {97 ,3591},
    {97 ,3588},
    {97 ,3586},
    {98 ,3584},
    {98 ,3583},
    {98 ,3582},
    {98 ,3580},
    {99 ,3579},
    {99 ,3578},
    {99 ,3577},
    {99 ,3576},
    {99 ,3575},
    {99 ,3575},
    {99 ,3574},
    {100,3573},
    {100,3573},
    {100,3572},
    {100,3572},
    {100,3571},
    {100,3570}
};   
     
// T1 0C
BATTERY_PROFILE_STRUC battery_profile_t1[] =
{
    {0  ,4166},
    {2  ,4141},
    {3  ,4123},
    {5  ,4106},
    {6  ,4091},
    {8  ,4076},
    {9  ,4062},
    {11 ,4047},
    {13 ,4033},
    {14 ,4019},
    {16 ,4006},
    {17 ,3994},
    {19 ,3982},
    {20 ,3971},
    {22 ,3959},
    {23 ,3948},
    {25 ,3938},
    {27 ,3927},
    {28 ,3916},
    {30 ,3905},
    {31 ,3894},
    {33 ,3882},
    {34 ,3871},
    {36 ,3858},
    {38 ,3845},
    {39 ,3834},
    {41 ,3825},
    {42 ,3817},
    {44 ,3810},
    {45 ,3804},
    {47 ,3798},
    {48 ,3794},
    {50 ,3790},
    {52 ,3787},
    {53 ,3785},
    {55 ,3784},
    {56 ,3782},
    {58 ,3781},
    {59 ,3780},
    {61 ,3778},
    {63 ,3776},
    {64 ,3774},
    {66 ,3771},
    {67 ,3767},
    {69 ,3762},
    {70 ,3756},
    {72 ,3748},
    {74 ,3738},
    {75 ,3727},
    {77 ,3714},
    {78 ,3699},
    {80 ,3681},
    {81 ,3663},
    {83 ,3645},
    {84 ,3626},
    {86 ,3609},
    {88 ,3592},
    {89 ,3576},
    {91 ,3560},
    {92 ,3543},
    {94 ,3530},
    {95 ,3516},
    {97 ,3507},
    {98 ,3501},
    {98 ,3497},
    {98 ,3494},
    {99 ,3491},
    {99 ,3489},
    {99 ,3486},
    {99 ,3484},
    {100,3482},
    {100,3480},
    {100,3478},
    {100,3475},
    {100,3474}
};

// T2 25C
BATTERY_PROFILE_STRUC battery_profile_t2[] =
{
    {0  ,4186},
    {1  ,4166},
    {3  ,4150},
    {4  ,4134},
    {6  ,4119},
    {7  ,4104},
    {9  ,4089},
    {10 ,4075},
    {12 ,4061},
    {13 ,4047},
    {15 ,4033},
    {16 ,4020},
    {18 ,4007},
    {19 ,3995},
    {21 ,3983},
    {22 ,3971},
    {24 ,3960},
    {25 ,3949},
    {27 ,3939},
    {28 ,3929},
    {30 ,3918},
    {31 ,3909},
    {32 ,3898},
    {34 ,3889},
    {35 ,3879},
    {37 ,3866},
    {38 ,3853},
    {40 ,3839},
    {41 ,3826},
    {43 ,3818},
    {44 ,3809},
    {46 ,3803},
    {47 ,3797},
    {49 ,3792},
    {50 ,3787},
    {52 ,3783},
    {53 ,3780},
    {55 ,3778},
    {56 ,3777},
    {57 ,3775},
    {59 ,3774},
    {60 ,3773},
    {62 ,3771},
    {63 ,3770},
    {65 ,3768},
    {66 ,3766},
    {68 ,3762},
    {69 ,3758},
    {71 ,3751},
    {72 ,3743},
    {74 ,3733},
    {75 ,3721},
    {77 ,3709},
    {78 ,3694},
    {80 ,3677},
    {81 ,3659},
    {83 ,3641},
    {84 ,3624},
    {85 ,3606},
    {87 ,3589},
    {88 ,3574},
    {90 ,3559},
    {91 ,3543},
    {93 ,3530},
    {94 ,3520},
    {96 ,3508},
    {97 ,3489},
    {99 ,3451},
    {100,3391},
    {100,3338},
    {100,3308},
    {100,3301},
    {100,3298},
    {100,3295},
    {100,3295}    
};

// T3 50C
BATTERY_PROFILE_STRUC battery_profile_t3[] =
{
    {0  ,4186},
    {1  ,4166},
    {3  ,4150},
    {4  ,4134},
    {6  ,4119},
    {7  ,4104},
    {9  ,4089},
    {10 ,4075},
    {12 ,4061},
    {13 ,4047},
    {15 ,4033},
    {16 ,4020},
    {18 ,4007},
    {19 ,3995},
    {21 ,3983},
    {22 ,3971},
    {24 ,3960},
    {25 ,3949},
    {27 ,3939},
    {28 ,3929},
    {30 ,3918},
    {31 ,3909},
    {32 ,3898},
    {34 ,3889},
    {35 ,3879},
    {37 ,3866},
    {38 ,3853},
    {40 ,3839},
    {41 ,3826},
    {43 ,3818},
    {44 ,3809},
    {46 ,3803},
    {47 ,3797},
    {49 ,3792},
    {50 ,3787},
    {52 ,3783},
    {53 ,3780},
    {55 ,3778},
    {56 ,3777},
    {57 ,3775},
    {59 ,3774},
    {60 ,3773},
    {62 ,3771},
    {63 ,3770},
    {65 ,3768},
    {66 ,3766},
    {68 ,3762},
    {69 ,3758},
    {71 ,3751},
    {72 ,3743},
    {74 ,3733},
    {75 ,3721},
    {77 ,3709},
    {78 ,3694},
    {80 ,3677},
    {81 ,3659},
    {83 ,3641},
    {84 ,3624},
    {85 ,3606},
    {87 ,3589},
    {88 ,3574},
    {90 ,3559},
    {91 ,3543},
    {93 ,3530},
    {94 ,3520},
    {96 ,3508},
    {97 ,3489},
    {99 ,3451},
    {100,3391},
    {100,3338},
    {100,3308},
    {100,3301},
    {100,3298},
    {100,3295},
    {100,3295}    
};

// battery profile for actual temperature. The size should be the same as T1, T2 and T3
BATTERY_PROFILE_STRUC battery_profile_temperature[] =
{
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0}    
};

/////////////////////////////////////////////////////////////////////
// <Rbat, Battery_Voltage> Table
/////////////////////////////////////////////////////////////////////
typedef struct _R_PROFILE_STRUC
{
    kal_int32 resistance; // Ohm
    kal_int32 voltage;
} R_PROFILE_STRUC, *R_PROFILE_STRUC_P;

// T0 -10C
R_PROFILE_STRUC r_profile_t0[] =
{
    {272,4158},
    {272,4128},
    {282,4102},
    {297,4078},
    {313,4057},
    {325,4037},
    {335,4020},
    {343,4006},
    {345,3992},
    {350,3980},
    {353,3968},
    {357,3957},
    {360,3945},
    {362,3934},
    {365,3923},
    {367,3912},
    {370,3901},
    {372,3890},
    {372,3878},
    {372,3867},
    {372,3856},
    {372,3844},
    {373,3834},
    {372,3824},
    {375,3816},
    {375,3808},
    {380,3803},
    {385,3798},
    {388,3793},
    {392,3790},
    {398,3788},
    {403,3786},
    {407,3784},
    {413,3783},
    {418,3781},
    {425,3779},
    {432,3776},
    {442,3774},
    {450,3770},
    {463,3766},
    {477,3761},
    {493,3755},
    {513,3748},
    {532,3738},
    {553,3727},
    {573,3713},
    {593,3698},
    {608,3681},
    {623,3663},
    {638,3645},
    {653,3627},
    {665,3612},
    {670,3602},
    {662,3597},
    {657,3594},
    {652,3591},
    {647,3588},
    {643,3586},
    {640,3584},
    {638,3583},
    {637,3582},
    {635,3580},
    {632,3579},
    {632,3578},
    {628,3577},
    {627,3576},
    {625,3575},
    {625,3575},
    {625,3574},
    {622,3573},
    {622,3573},
    {622,3572},
    {622,3572},
    {620,3571},
    {333,3400}
};

// T1 0C
R_PROFILE_STRUC r_profile_t1[] =
{
    {197,4166},
    {197,4141},
    {203,4123},
    {205,4106},
    {207,4091},
    {208,4076},
    {212,4062},
    {213,4047},
    {217,4033},
    {217,4019},
    {218,4006},
    {220,3994},
    {222,3982},
    {225,3971},
    {227,3959},
    {228,3948},
    {232,3938},
    {232,3927},
    {233,3916},
    {233,3905},
    {233,3894},
    {232,3882},
    {230,3871},
    {227,3858},
    {222,3845},
    {220,3834},
    {218,3825},
    {218,3817},
    {218,3810},
    {220,3804},
    {218,3798},
    {222,3794},
    {222,3790},
    {225,3787},
    {227,3785},
    {230,3784},
    {230,3782},
    {233,3781},
    {237,3780},
    {238,3778},
    {242,3776},
    {247,3774},
    {252,3771},
    {255,3767},
    {263,3762},
    {272,3756},
    {282,3748},
    {292,3738},
    {305,3727},
    {318,3714},
    {328,3699},
    {337,3681},
    {343,3663},
    {350,3645},
    {353,3626},
    {362,3609},
    {368,3592},
    {378,3576},
    {390,3560},
    {402,3543},
    {427,3530},
    {458,3516},
    {485,3507},
    {500,3501},
    {495,3497},
    {490,3494},
    {485,3491},
    {482,3489},
    {477,3486},
    {475,3484},
    {470,3482},
    {467,3480},
    {463,3478},
    {460,3475},
    {335,3400}
};

// T2 25C
R_PROFILE_STRUC r_profile_t2[] =
{
    {120,4186},
    {120,4166},
    {123,4150},
    {123,4134},
    {125,4119},
    {125,4104},
    {125,4089},
    {127,4075},
    {127,4061},
    {127,4047},
    {127,4033},
    {128,4020},
    {128,4007},
    {130,3995},
    {130,3983},
    {130,3971},
    {132,3960},
    {133,3949},
    {135,3939},
    {137,3929},
    {137,3918},
    {140,3909},
    {140,3898},
    {142,3889},
    {143,3879},
    {140,3866},
    {137,3853},
    {132,3839},
    {127,3826},
    {127,3818},
    {123,3809},
    {125,3803},
    {125,3797},
    {125,3792},
    {123,3787},
    {123,3783},
    {125,3780},
    {125,3778},
    {127,3777},
    {127,3775},
    {128,3774},
    {128,3773},
    {128,3771},
    {132,3770},
    {133,3768},
    {135,3766},
    {135,3762},
    {137,3758},
    {137,3751},
    {137,3743},
    {137,3733},
    {137,3721},
    {142,3709},
    {143,3694},
    {143,3677},
    {145,3659},
    {147,3641},
    {148,3624},
    {147,3606},
    {147,3589},
    {148,3574},
    {150,3559},
    {148,3543},
    {150,3530},
    {155,3520},
    {160,3508},
    {165,3489},
    {168,3451},
    {178,3391},
    {183,3338},
    {180,3308},
    {168,3301},
    {165,3298},
    {158,3295},
    {160,3295}  
};

// T3 50C
R_PROFILE_STRUC r_profile_t3[] =
{
    {120,4186},
    {120,4166},
    {123,4150},
    {123,4134},
    {125,4119},
    {125,4104},
    {125,4089},
    {127,4075},
    {127,4061},
    {127,4047},
    {127,4033},
    {128,4020},
    {128,4007},
    {130,3995},
    {130,3983},
    {130,3971},
    {132,3960},
    {133,3949},
    {135,3939},
    {137,3929},
    {137,3918},
    {140,3909},
    {140,3898},
    {142,3889},
    {143,3879},
    {140,3866},
    {137,3853},
    {132,3839},
    {127,3826},
    {127,3818},
    {123,3809},
    {125,3803},
    {125,3797},
    {125,3792},
    {123,3787},
    {123,3783},
    {125,3780},
    {125,3778},
    {127,3777},
    {127,3775},
    {128,3774},
    {128,3773},
    {128,3771},
    {132,3770},
    {133,3768},
    {135,3766},
    {135,3762},
    {137,3758},
    {137,3751},
    {137,3743},
    {137,3733},
    {137,3721},
    {142,3709},
    {143,3694},
    {143,3677},
    {145,3659},
    {147,3641},
    {148,3624},
    {147,3606},
    {147,3589},
    {148,3574},
    {150,3559},
    {148,3543},
    {150,3530},
    {155,3520},
    {160,3508},
    {165,3489},
    {168,3451},
    {178,3391},
    {183,3338},
    {180,3308},
    {168,3301},
    {165,3298},
    {158,3295},
    {160,3295} 
};

// r-table profile for actual temperature. The size should be the same as T1, T2 and T3
R_PROFILE_STRUC r_profile_temperature[] =
{
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0},
    {0, 0}    
};


int fgauge_get_saddles(void);
BATTERY_PROFILE_STRUC_P fgauge_get_profile(kal_uint32 temperature);

int fgauge_get_saddles_r_table(void);
R_PROFILE_STRUC_P fgauge_get_profile_r_table(kal_uint32 temperature);

//#define CONFIG_POWER_VERIFY
